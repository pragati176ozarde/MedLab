!function(){"use strict";define(["_routes"],function(e){e.register.controller("newWalletBenController",["$scope","authService","apiProvider","$rootScope","$window","$http","$sce","navConstantsSvc",function(e,a,l,i,t,n,c,s){t.scrollTo(0,0);var o=a.isUserSignedin();e.benefits=[],e.isLoading=!0,e.user=a.getUserObj(),e.policyEndDate=null,e.init=function(){e.selectedBenef="Self",e.wallets=a.walletDetails?a.walletDetails.length:0;var l=_.findWhere(a.walletDetails,{walletName:"MAWallet"});e.MAWalletFound=!_.isEmpty(l),e.walletname=e.MAWalletFound?"MAWallet":"CORPWallet",e.MABalance=l&&l.balance?l.balance:a.MABalance,a.MBBalance>0&&!_.findWhere(a.walletConfigs,{walletName:"MBWallet"})&&a.walletConfigs.push({walletName:"MBWallet"}),e.corpBalance=a.CorpBalance%1==0?a.CorpBalance:a.CorpBalance.toFixed(2),e.MBBalance=a.MBBalance%1==0?a.MBBalance:a.MBBalance.toFixed(2),e.MaWalletName=a.maAliasName,e.corpWalletName=a.corpAliasName,e.availableBalance=0==e.corpBalance?e.MABalance:e.corpBalance,i.getWalletBenefits(e.walletname,"Self",e.user.corpDetails.employeeDetail?e.user.corpDetails.employeeDetail.beneficiaries[0].maid:"")},e.beneficiaries=e.user.corpDetails.employeeDetail?e.user.corpDetails.employeeDetail.beneficiaries:[{maid:null,relationId:1,relationName:"Self"}],i.getWalletBenefits=function(a,i,t){e.selectedBenef=i,n.post(l.infinitiNode+"WalletBenefits",{empId:e.user.corpDetails.iwpEmployeeId,pmEntityId:e.user.userDetails.pmEntityID,walletName:a,relation:i,authUserId:o.userDetails.userId,maid:t}).then(function(a){e.benefits=[],e.isLoading=!1,e.policyEndDate=a.data.policyEndDate,a.data.result.forEach(function(a){if(a.displayName){a.total_limit||(a.total_limit=e.availableBalance,a.balance=e.availableBalance),a.balance>e.availableBalance&&(a.balance=e.availableBalance);var l="";if(a.sponceredServices){var i=JSON.parse(a.sponceredServices).slice(0,4);l+=" (Specialities/speciality covered via wallet: "+i.join(", ")+")"}e.benefits.push({name:a.displayName+l,description:a.displayName+" covered up to "+a.total_limit,balance:a.balance>=0?a.balance%1==0?a.balance:a.balance.toFixed(2):0,image:"/assets/images/walletSublimitIcon.svg"})}})})["catch"](function(a){e.isLoading=!1,console.log(a)})},e.init(),e.cancelDialog=function(){this.$dismiss()}}])})}();