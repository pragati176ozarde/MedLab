!function(){"use strict";define(["_routes","utility"],function(e,t){e.register.controller("ecardController",["$scope","authService","apiProvider","$state","$rootScope","$sce","$window","$location","seoService","$http","$interval","standardEventsSvc",function(e,a,n,i,r,o,s,d,c,l,m,u){function p(e){var t=new Date;return t.setTime(t.getTime()+60*e*60*1e3),t.toUTCString()}e.displayCustomBanner=!0;var f,h=this;e.chatUrl=o.trustAsResourceUrl(n.chatUrl),e.trustedUrl1=o.trustAsResourceUrl("https://223.31.103.204/HeritageHealthTPA/HOME/CardSearch.aspx"),e.trustedUrl2=o.trustAsResourceUrl("https://www.fhpl.net/#/claim_tracking"),e.trustedUrl3=o.trustAsResourceUrl("https://healthindiatpa.com/CustomerCorner/ECard.aspx"),e.ecardLinkVidal=o.trustAsResourceUrl("https://www.youtube.com/embed/9pkF8OUpERM?si=_uuGI7BhA92_cgYF"),e.getSafeUrl=function(e){return o.trustAsResourceUrl(e)},h.faqs=[{question:"What is it recommended to have a digital e card with you at all times?",answer:"Carrying a digital e-card at all times is increasingly recommended due to its convenience, accessibility, and practicality in various situations. These digital cards, stored on smartphones or other devices, serve as a repository for crucial personal information, emergency contacts, and essential details that can prove invaluable in unexpected circumstances."},{question:"What to do in case you are not able to download the ecard?",answer:"There may be intermittent failures when we do not receive card information from the respective issuers. We request you to try again after some time. In case your issue is not resolved, we request you to try downloading the e card from the issuer website directly."},{question:"How to check if my family members are covered in insurance or not ?",answer:"Once you submit the details, you should get e-cards for all your enrolled members"}],e.toggleExpand=function(e,t){_.each(t,function(t){t.question!==e.question&&(t.expanded=!1)}),_.isEmpty(t)||_.each(t,function(t){t.question!==e.question&&(t.expanded=!1)}),e.expanded=!e.expanded},e.setMediAssistLink=function(){var e=document.cookie,a=e.split(";"),i="";if(a.forEach(function(e){var t=e.trim().split("="),a=t[0],n=t[1];"maLinksVariant"==a&&(i=n)}),i)"A"==i?(n.ecardLink="/ecard",n.networkHospital="/networkHospitals",t.fireSnowPlowEvent(u.ECARD_CLICK2.name,u.ECARD_CLICK2.schema,{platform:"",variant:"new"})):(t.fireSnowPlowEvent(u.ECARD_CLICK2.name,u.ECARD_CLICK2.schema,{platform:"",variant:"old"}),document.cookie="maLinksVariant=B; expires="+p(24),setTimeout(function(){s.location.href="https://mediassisttpa.in/download-ecard/"},500));else{var r=Math.random();r<=.95?(n.ecardLink="/ecard",n.networkHospital="/networkHospitals",document.cookie="maLinksVariant=A; expires="+p(24),t.fireSnowPlowEvent(u.ECARD_CLICK2.name,u.ECARD_CLICK2.schema,{platform:"",variant:"new"})):(t.fireSnowPlowEvent(u.ECARD_CLICK2.name,u.ECARD_CLICK2.schema,{platform:"",variant:"old"}),document.cookie="maLinksVariant=B; expires="+p(24),setTimeout(function(){s.location.href="https://mediassisttpa.in/download-ecard/"},500))}},e.setMediAssistLink(),h.radioCheck="radio_maid",h.hideVideo=!0,h.submitButtonClicked=!1,h.tpaList=[{tpa:"Medi Assist",link:"",iframeLinkAvailable:!1,ecardLink:"https://mediassisttpa.in/download-ecard/",videoLink:""},{tpa:"Family Health Plan Insurance",link:e.trustedUrl2,iframeLinkAvailable:!0,ecardLink:"https://www.fhpl.net/#/claim_tracking",videoLink:""},{tpa:"Health India Insurance",link:e.trustedUrl3,iframeLinkAvailable:!0,ecardLink:"https://healthindiatpa.com/CustomerCorner/ECard.aspx",videoLink:""},{tpa:"Vidal Health Insurance",link:"",iframeLinkAvailable:!1,ecardLink:"https://vidalhealthtpa.com/employeeportal/",videoLink:"https://youtu.be/zmmdLlh_Jh0?si=fy0D-j5_N8z4lhbA"},{tpa:"Paramount Health Insurance",link:"",iframeLinkAvailable:!1,ecardLink:"https://www.paramounttpa.com/Home/InstantEcard.aspx",videoLink:"https://youtu.be/yQyvb7IABsw?si=qwD1s1F2IokFKAzq"},{tpa:"Raksha Health Insurance",link:"",iframeLinkAvailable:!1,ecardLink:"https://www.rakshatpa.com/WebPortal/Login/Anonymous/ECard",videoLink:"https://www.youtube.com/embed/9pkF8OUpERM?si=_uuGI7BhA92_cgYF"}],h.updateTpa=function(e){h.tpa=e.tpa,h.tpaLink=e.link,h.iframeLinkAvailable=e.iframeLinkAvailable,h.videoLink=e.videoLink},h.faqQuestion=["What is it recommended to have adigital e card with you at all times?","What to do in case you are not able to download the ecard?","How to check if my family members are covered in insurance or not ?"],h.tpa="Medi Assist",h.tpaLink="https://healthindiatpa.com/CustomerCorner/ECard.aspx",h.encryptedUserResponse="",h.ecardLink="",h.videoLink="https://www.youtube.com/embed/9pkF8OUpERM?si=_uuGI7BhA92_cgYF",h.iframeLinkAvailable=!1,e.cityName=a.getCity(),h.setOtpState=function(){h.otpPhrase="",h.userInfo={},h.formSubmitted=!1},h.setOtpState(),h.noResponse=!1,s.scrollTo(0,0);var b={},y="";e.checkUser=a.isUserSignedin(),e.accessToken="",e.checkUser&&e.checkUser.token&&(e.accessToken=e.checkUser.token),h.verifyOtp=function(){switch(b={dob:h.dob},h.radioCheck){case"radio_empid":_.extend(b,{employeeId:h.empid,corporateName:h.compname,isClaimRequest:!1,isEcardRequest:!0,dob:h.dob}),y=n.mediassistEcardIdentify;break;case"radio_policyno":_.extend(b,{policyNo:h.polno,name:h.benefname,isClaimRequest:!1,isEcardRequest:!0}),y=n.mediassistEcardIdentify;break;default:_.extend(b,{claimId:h.maid,relationId:0,doa:h.dob,employeeId:h.empid,isClaimRequest:!1,isEcardRequest:!0,name:h.benefname}),y=n.mediassistEcardIdentify}h.viewEcard()},h.verifyOtp2=function(){var e={emailId:h.emailid,phone:h.phone,memberid:h.memberid,empid:h.empid,Name:h.memberid,Email:h.emailid,MobileNumber:h.phone,getInTouchLocation:"Bengaluru",Surgery:h.memberid,utmSource:"fromNewEcardPage",accessToken:""};try{var t="https://surgeryapi.medibuddy.in/surgery";a.makeAjaxCalls(t,e,"POST").then(function(e){201==e.status&&(h.submitButtonClicked=!0,h.noResponse=!1,h.formSubmitted=!0,h.success=!0)},function(e){})}catch(n){}},h.toggleVideo=function(){h.hideVideo=!h.hideVideo},h.redirectToLink=function(e){window.location.href=e},c.getSeoContent({categoryItemTypeId:"04533ffcda6345093ff76df89d617d39"}),h.viewEcard=function(){h.errorMessage="",a.makeAjaxCalls(y,b,"POST").then(function(t){if(t.data.isSuccess||"radio_policyno"===h.radioCheck&&t.data.ecardLink){if(h.noResponse=!1,h.formSubmitted=!0,h.success=!0,h.ecardLink=t.data.ecardLink,h.ecardLink){var a=n.medassistEcardDownload+h.ecardLink;s.open(a,"_blank")}t.data.ecardHtml?(h.setOtpState(),h.ecardHtml=o.trustAsHtml(t.data.ecardHtml.substring(t.data.ecardHtml.indexOf("<body"),t.data.ecardHtml.indexOf("</body>")+7)),t.data.benefs&&(h.benefObj=t.data.benefs,h.downloadMaid=h.benefObj.benefMediAssistID,h.downloadBenefName=h.benefObj.benefName),h.formSubmitted=!1,h.success=!0):(h.relations=t.data.familyMember,h.userInfo.otpToken=t.data.encryptedUserResponse||h.formSubmitted,h.encryptedUserResponse=t.data.encryptedUserResponse,h.message=o.trustAsHtml(t.data.message),e.timer=60,m.cancel(f),f=m(function(){0!==e.timer&&e.timer--},1e3))}else h.setOtpState(),h.formSubmitted=!1,h.success=!1,t.data.errorMessage?(h.errorMessage=o.trustAsHtml(t.data.errorMessage),h.noResponse=!1):h.noResponse=!0},function(e){})},e.trackLeads=function(){a.makeAjaxCalls("https://surgeryapi.medibuddy.in/leads/trackLead",{utmSource:"homeContent-ecards",accessToken:e.accessToken},"POST")},e.typeformShown=!0,e.showTypeform=function(){return"https://www.medibuddy.in/ecard"===window.location.href},e.addTypeformScript=function(){var e=document.createElement("script");e.src="/assets/typeform/embed.js",e.id="typeform_script",document.body.appendChild(e)},e.$watch("showTypeform()",function(t){t&&(e.typeformShown=!0,e.addTypeformScript())}),e.getBannerDetails=function(){a.getBannerPlatformPath("medibuddy","Ecard",!1).then(function(t){var a=t;a.forEach(function(t){"medibuddyEcardFirstFoldFirstWeb"==t.banneruniqueid?e.bannerUrlAppDownload=t.bannerurl:"medibuddyEcardFirstFoldFirstMob"==t.banneruniqueid?e.bannerUrlAppDownloadMob=t.bannerurl:"medibuddyEcardFirstFoldSecondWeb"==t.banneruniqueid?(e.bannerUrlSurgery=t.bannerurl,e.redirectionBannerSurgery=e.redirectionUrlUpdate(t.redirectionlink)):"medibuddyEcardFirstFoldSecondMob"==t.banneruniqueid&&(e.bannerUrlSurgeryMob=t.bannerurl,e.redirectionBannerSurgery=e.redirectionUrlUpdate(t.redirectionlink))})})["catch"](function(e){console.log(e)})},e.getBannerDetails(),e.redirectionUrlUpdate=function(t){return e.redirectionUrl=t,e.redirectionUrl.includes("accessToken")&&(e.redirectionUrl=e.redirectionUrl+e.accessToken),e.redirectionUrl},e.$on("$destroy",function(){for(var e=document.querySelectorAll("#typeform_script"),t=0;t<e.length;t++)e[t].parentNode.removeChild(e[t]);for(var a=document.querySelectorAll(".tf-v1-sidetab"),t=0;t<e.length;t++)a[t].parentNode.removeChild(a[t])}),e.trackLeads(),h.benefSearch=function(){if("radio_maid"===h.radioCheck){for(var e={},t=0;t<h.relations.length;t++)if(h.relations[t].name===h.relation.name){e.index=t,e.id=h.relations[t].id;break}b={benef2Dob:h.dob2,encryptedUserResponse:h.encryptedUserResponse,isEcardRequest:!0,corporateName:h.compname,employeeId:h.empid,claimId:h.maid,benef2id:e},b.doa=h.dob}else if("radio_empid"===h.radioCheck)b={benef2Dob:h.dob2,encryptedUserResponse:h.encryptedUserResponse,isEcardRequest:!0,corporateName:h.compname,dob:h.dob,employeeId:h.empid};else{for(var e={},t=0;t<h.relations.length;t++)if(h.relations[t].name===h.relation.name){e.index=t,e.id=h.relations[t].id;break}b={benef2Dob:h.dob2,encryptedUserResponse:h.encryptedUserResponse,isEcardRequest:!0,dob:h.dob,employeeId:h.empid,benef2id:e,name:h.benefname,policyNo:h.polno}}y=n.mediassistEcardVerify,h.viewEcard()},h.allowOnlyNumbers=function(e){var t=e.charCode?e.charCode:e.keyCode;return!(t>31&&(t<48||t>57))||(e.preventDefault(),!1)},h.printEcard=function(){var e=s.open("","_blank","width=900,height=600");e.document.open(),e.document.write('<html><head><link rel="stylesheet" type="text/css" href="style.css" /></head><body onload="window.print()">'+h.ecardHtml+"</body></html>"),e.document.close()},h.downloadEcardWithMaid=function(){var e=n.apiUrl+"/infiniti/track/getEcard/MAID/"+h.downloadMaid+"/"+h.downloadBenefName;s.open(e,"_blank")}}])})}();